# 前言

当我还是一名学生时，我有幸见到了不起的 Alan Perlis 并与他交谈了几次。他和我对两种截然不同的编程语言有着共同的热爱和尊重：Lisp 和 APL。追随他的脚步是一项艰巨的任务，尽管他开辟了一条出色的道路。尽管如此，我还是想重新审视他在本书原始前言中的一条评论（并且，我建议您在完成这一篇之前先阅读他的前言，紧接在这一篇之后）。让 100 个函数对一个数据结构进行操作真的比让 10 个函数对 10 个数据结构进行操作更好吗？

要仔细回答这个问题，我们首先要问，这个数据结构是否“通用”：它能方便地完成那 10 个更专业的数据结构的作用吗？

就此而言，我们还可以问：我们真的需要 100 个函数吗？是否有一个单一的通用功能可以完成所有其他功能的角色？

那个最后一个问题的惊人答案是“是的”; 构建一个接受（1）作为另一个函数描述的数据结构和（2）参数列表的函数，且在应用于给定参数时表现得完全像另一个函数只是稍微有点棘手。并且稍微有点棘手地设计一个能够描述任何计算的数据结构。本书第4章描述了这样一种数据结构（表示表达式和语句的标记列表，与将名称与值相关联的环境配对）和这样一种通用函数（apply）。因此，也许我们只需要一个函数和一个数据结构。

这在理论上是正确的。在实践中，我们发现区分有助于我们作为人类构建计算描述来组织我们代码的结构以便更好地理解它们是很方便的。我相信 Perlis 不是在谈论计算能力，而是在谈论人类的能力和人类的局限性。

人类思维似乎擅长的一件事就是给事物命名；我们有强大的联想记忆。给定一个名字，我们可以快速回忆起一些相关的事物。这就是为什么我们通常发现使用 lambda 演算比使用组合演算更容易；对于大多数人来说，解释 Lisp 表达式 `(lambda (x) (lambda (y) (+ x y)))` 或 JavaScript 表达式 `x => y => x + y` 要比组合表达式 `((S ((S (K S)) ((S ((S (K S)) ((S (K K)) (K +)))) ((S (K K)) I)))) (K I))` 容易得多，即使存在直接的结构对应关系，也很容易用五行Lisp代码表示。

因此，虽然原则上我们可以只使用一个通用函数，但我们更愿意模块化我们的代码，为不同的部分命名，并提及函数描述的名称，而不是不断地将描述本身提供给通用函数。

在我 1998 年的演讲“发展一种语言”中，我评论道：“一个好的程序员不只是编写程序，一个好的程序员会建立一个工作词汇表。” 随着我们设计和定义越来越多的程序部分，我们给这些部分命名，结果是我们有更丰富的语言来编写其余部分。

但是我们也发现在数据结构之间进行区分并给它们命名是很自然的。

嵌套列表可能是一种通用数据结构（值得注意的是，许多现代和广泛使用的数据结构，例如 HTML 和 XML 和 JSON，也是括号嵌套表示，只是比 Lisp 的裸括号稍微复杂一点）。还有许多函数，例如查找列表的长度或将函数应用于列表的每个元素并返回结果列表，这些函数在各种情况下都很有用。然而，当我在考虑一个特定的计算时，我经常对自己说，“我希望这个两件事的列表是一个人的名字和一个姓氏，但那两件事的列表我希望是实部和虚部 一个复数，还有另外两个我将视为分数的分子和分母的列表。” 换句话说，我进行了区分——在数据结构中明确表示这些区分可能很有用，部分原因是为了防止错误，例如不小心将复数视为分数。（同样，这是对人类能力和人类局限性的评论。）

自本书第一版问世以来，将近四十年前，更多组织数据的方法已经成为相对标准的方法，尤其是“面向对象”的方法，并且包括 JavaScript 在内的许多语言都支持专门的数据结构，例如 具有各种内置机制和库的对象、字符串、堆和映射。但在这样做的过程中，许多语言放弃了对更一般、更普遍的概念的支持。例如，Java 最初不支持一等函数，直到最近才加入，大大增强了它的表达能力。

同样，APL 最初也不支持一流的函数，而且其原始的单一数据结构——任意维数的数组——不像通用数据结构那样方便有用，因为数组不能包含其他数组作为元素。APL 的最新版本确实支持匿名函数值和嵌套数组，这些使 APL 的表现力显着增强。（APL 的最初设计确实有两个非常好的方面：适用于该数据结构的一组综合函数，以及为这些函数精心挑选的一组名称。我不是在谈论有趣的符号 和希腊字母，但 APL 程序员在提到它们时使用的口语词，如形状、重塑、压缩、扩展和层压等词；这些名称不是符号，而是它们所代表的功能。Ken Iverson非常擅长为数组上的函数选择简短、好记、生动的名称）

虽然 JavaScript 和 Java 一样，最初在设计时就考虑到了对象和方法，但它从一开始就结合了一流的功能，使用它的对象来定义一个通用的数据结构并不困难。因此，JavaScript 与 Lisp 的距离并不像您想象的那么遥远，正如本版计算机程序的结构和解释所展示的那样，它是展示关键思想的一个很好的替代框架。SICP 从来都不是一种编程语言。它为程序组织提供了强大的、通用的思想，应该对任何语言都有用。

Lisp 和 JavaScript 有什么共同点？抽象计算（代码加上一些相关数据）以供以后作为函数执行的能力；在数据结构中嵌入对此类函数的引用的能力；在参数上调用函数的能力；区分的能力（有条件的执行）；方便的通用数据结构；对该数据进行完全自动的存储管理（考虑到其他一切，这看起来很简单，直到您意识到许多广泛使用的编程语言都没有它）；用于对该通用数据结构进行操作的大量有用函数；以及使用通用数据结构来表示更专业的数据结构的标准策略。

因此，也许事实介于 Perlis 如此雄辩地假设的两个极端之间。也许最佳地点是更像40个足够通用的函数，可以在通用数据结构（如列表）上有效地运行，但也有10组6个函数，当我们对通用数据结构进行10个专门视图中的一个时，每个函数都相关。如果我们给这些函数和专门视图起好名字，这是可以管理的。

当你阅读这本书时，请不仅注意编程语言结构和它们是如何使用的，还要注意给函数、变量和数据结构起的名字。它们并不都像 Iverson 为他的 APL 函数选择的名字那样简短生动，但它们是以深思熟虑和系统的方式选择的，以增强你对整体程序结构的理解。

原语、组合方法、函数抽象、命名和通过区分以专门方式使用通用数据结构的约定：这些是好编程语言的基本组成部分。从那里，基于经验的想象力和良好的工程判断可以完成剩下的工作。

> \- 盖伊·斯蒂尔二世，马萨诸塞州列克星敦，2021年
